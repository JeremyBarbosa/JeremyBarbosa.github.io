<!doctype html><html><head><meta charset=utf-8><meta content="width=device-width,initial-scale=1" name=viewport><title>trvl plnnr</title><link href=/packages/bootstrap-reboot.min.css rel=stylesheet><link href=/packages/bootstrap-grid.min.css rel=stylesheet><link href=/packages/bootstrap-utilities.min.css rel=stylesheet><link href=/packages/bootstrap.min.css rel=stylesheet><script src=/packages/bootstrap.bundle.min.js></script><script src=/packages/Sortable.min.js></script><style>body{background:#75c2f6}[id^='day-']{background:#ffeadd}.card{max-height:10rem;overflow:hidden}.card img{height:100%;width:100%;object-fit:cover;border-top-right-radius:0;border-top-left-radius:calc(0.25rem - 1px);border-bottom-left-radius:calc(0.25rem - 1px)}.card-title{font-weight:700;height:3.5rem;overflow:hidden}.dragging{background:#1d5d9b;color:white}.error{background:#f65a83}</style><body><header><h1 class="display-4 text-white text-center mt-1">trvl plnnr</h1></header><div class="modal fade" aria-hidden=true aria-labelledby=removeModalLabel id=removeModal tabindex=-1><div class=modal-dialog><div class=modal-content><div class=modal-header><h1 class="modal-title fs-5" id=removeModalLabel>Remove Event</h1><button aria-label=Close class=btn-close data-bs-dismiss=modal type=button></button></div><div class=modal-body><form id=removeForm><fieldset><legend>How should this event be removed?</legend><div id=fillDiv><input checked id=fill name=remove type=radio value=fill><label class=ps-2 for=fill>Fill with a "Free Time" event</label></div><div id=morePrevDiv><input id=morePrev name=remove type=radio value=morePrev><label class=ps-2 for=morePrev>Spend more time at the previous location</label></div><div id=moreNextDiv><input id=moreNext name=remove type=radio value=moreNext><label class=ps-2 for=moreNext>Spend more time at the next location</label></div></fieldset></form></div><div class=modal-footer><button class="btn btn-secondary" data-bs-dismiss=modal type=button>Close</button><button class="btn btn-primary" data-bs-dismiss=modal form=removeForm>Remove Event</button></div></div></div></div><div class="modal fade" aria-hidden=true aria-labelledby=pushModalLabel id=pushModal tabindex=-1><div class=modal-dialog><div class=modal-content><div class=modal-header><h1 class="modal-title fs-5" id=pushModalLabel>Push Events</h1><button aria-label=Close class=btn-close data-bs-dismiss=modal type=button></button></div><div class=modal-body><form id=pushForm><fieldset><legend>How should the other events in the day be adjusted?</legend><div id=pushDownDiv><input id=pushDown name=push type=radio value=pushDown><label class=ps-2 for=pushDown>Push all of the events before this one to earlier in the day</label></div><div id=pushUpDiv><input id=pushUp name=push type=radio value=pushUp><label class=ps-2 for=pushUp>Push all of the events after this one to later in the day</label></div></fieldset></form></div><div class=modal-footer><button class="btn btn-secondary" data-bs-dismiss=modal type=button>Close</button><button class="btn btn-primary" data-bs-dismiss=modal form=pushForm>Push Events</button></div></div></div></div><script>const times=document.querySelectorAll("input[type=time]");for(const a of times){a.addEventListener("change",b=>{let c=b.target.closest(".card");if(b.target.className=="beginning"){let d=getPrevCard(c);getEndingTime(d).value=b.target.value;checkDurationOfCard(d)}else{let d=getNextCard(c);getBeginningTime(d).value=b.target.value;checkDurationOfCard(d)};checkDurationOfCard(c)})};const removeButtons=document.getElementsByClassName("removeButton");for(const a of removeButtons){a.addEventListener("click",b=>{const c=b.target.closest(".card");if(c.querySelector(".card-title").innerHTML=="Free Time"){document.querySelector("#fillDiv").style.display="none"}else{document.querySelector("#fillDiv").style.display="inline-block"};if(!getPrevCard(c)){document.querySelector("#morePrevDiv").style.display="none"}else{document.querySelector("#morePrevDiv").style.display="inline-block"};if(!getNextCard(c)){document.querySelector("#moreNextDiv").style.display="none"}else{document.querySelector("#moreNextDiv").style.display="inline-block"}})};let removeTriggerButton;const removeModal=document.getElementById('removeModal');const pushModal=document.getElementById('pushModal');const input=document.getElementById('fill');removeModal.addEventListener('shown.bs.modal',a=>{input.focus();removeTriggerButton=a.relatedTarget});const removeForm=document.getElementById('removeForm');removeForm.addEventListener("submit",a=>{a.preventDefault();const b=new FormData(removeForm);const c=removeTriggerButton.closest(".card");const d=getPrevCard(c);const e=getNextCard(c);switch(b.get("remove")){case "fill":makeCardFreeTime(c);break;case "morePrev":addDurationToTime(getEndingTime(d),getDurationOfCard(c));c.remove();break;case "moreNext":subtractDurationToTime(getBeginningTime(e),getDurationOfCard(c));c.remove();break}},false);let draggedCard;const pushForm=document.getElementById('pushForm');pushForm.addEventListener("submit",a=>{a.preventDefault();const b=new FormData(pushForm);let c=getDurationOfCard(draggedCard);if(b.get("push")=="pushDown"){let f=getPrevCard(draggedCard);while(f){subtractDurationToTime(getBeginningTime(f),c);subtractDurationToTime(getEndingTime(f),c);f=getPrevCard(f)}}else{let f=getNextCard(draggedCard);while(f){addDurationToTime(getBeginningTime(f),c);addDurationToTime(getEndingTime(f),c);f=getNextCard(f)}};let d=getPrevCard(draggedCard);let e=getNextCard(draggedCard);if(d){getBeginningTime(draggedCard).value=getEndingTime(d).value}else{getBeginningTime(draggedCard).value=getBeginningTime(e).value;subtractDurationToTime(getBeginningTime(draggedCard),c)};if(e){getEndingTime(draggedCard).value=getBeginningTime(e).value}else{getEndingTime(draggedCard).value=getEndingTime(d).value;addDurationToTime(getEndingTime(draggedCard),c)}},false);let startingSortables=[];for(let a=0;a<3;a++){const b=document.getElementById("day-"+ a);let c=Sortable.create(b,{group:{name:"shared",pull:"clone",revertClone:true},draggable:".card",animation:150,ghostClass:"dragging",delay:400,delayOnTouchOnly:true,touchStartThreshold:3,store:{set:function(d){}},onClone:function(d){makeCardFreeTime(d.clone)},onEnd:function(d){draggedCard=d.item;if(!getPrevCard(draggedCard)){document.querySelector("#pushDownDiv").style.display="none"}else{document.querySelector("#pushDownDiv").style.display="inline-block"};if(!getNextCard(draggedCard)){document.querySelector("#pushUpDiv").style.display="none"}else{document.querySelector("#pushUpDiv").style.display="inline-block"};let e=new bootstrap.Modal(document.getElementById('pushModal'));e.show()}});startingSortables.push(c.toArray())};function getBeginningTime(a){return a.querySelector(".beginning")}function getEndingTime(a){return a.querySelector(".ending")}function timeInputToDate(a){return new Date('1970-01-01T'+ a.value+ ':00Z')}function getDurationOfCard(a){let b=getBeginningTime(a);let c=getEndingTime(a);let d=timeInputToDate(b);let e=timeInputToDate(c);let f=e- d;return f/1000/60}function addDurationToTime(a,b){let c=timeInputToDate(a);c.setMinutes(c.getMinutes()+ b);let d=c.getUTCHours();let e=c.getUTCMinutes();a.value=('0'+ d).slice(-2)+ ':'+ ('0'+ e).slice(-2)}function subtractDurationToTime(a,b){addDurationToTime(a,-b)}function makeCardFreeTime(a){a.dataset.id="Free Time";a.querySelector(".img-fluid").src="/images/paris/free.jpg";a.querySelector(".card-title").innerHTML="Free Time";a.querySelector(".card-text").innerHTML="Do whatever you want"}function getNextCard(a){const b=a.nextElementSibling;if(!b||!b.className.includes("card")){return null}else{return b}}function getPrevCard(a){const b=a.previousElementSibling;if(!b||!b.className.includes("card")){return null}else{return b}}function checkDurationOfCard(a){let b=getDurationOfCard(a);if(b<=0){a.classList.add("error")}else{a.classList.remove("error")}}</script>